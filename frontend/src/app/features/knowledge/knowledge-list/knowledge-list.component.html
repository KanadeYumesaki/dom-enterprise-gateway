<div class="knowledge-list-container">
    <!-- ローディング表示 -->
    @if (isLoading()) {
    <div class="loading-state">
        <p>読み込み中...</p>
    </div>
    }

    <!-- テーブル表示 -->
    @if (!isLoading()) {
    <table mat-table [dataSource]="dataSource" matSort class="knowledge-table">
        <!-- ファイル名カラム -->
        <ng-container matColumnDef="fileName">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>ファイル名</th>
            <td mat-cell *matCellDef="let doc">
                <mat-icon [fontIcon]="getFileIcon(doc.fileType)" class="file-icon"></mat-icon>
                {{ doc.fileName }}
            </td>
        </ng-container>

        <!-- ファイルタイプカラム -->
        <ng-container matColumnDef="fileType">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>タイプ</th>
            <td mat-cell *matCellDef="let doc">{{ doc.fileType || '不明' }}</td>
        </ng-container>

        <!-- ファイルサイズカラム -->
        <ng-container matColumnDef="fileSize">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>サイズ</th>
            <td mat-cell *matCellDef="let doc">{{ doc.fileSize || '-' }}</td>
        </ng-container>

        <!-- 作成日時カラム -->
        <ng-container matColumnDef="createdAt">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>アップロード日時</th>
            <td mat-cell *matCellDef="let doc">{{ doc.createdAt | date:'short' }}</td>
        </ng-container>

        <!-- アクションカラム -->
        <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef>操作</th>
            <td mat-cell *matCellDef="let doc">
                <button mat-icon-button (click)="onViewDetail(doc.id)" matTooltip="詳細を表示">
                    <mat-icon>visibility</mat-icon>
                </button>
            </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>

    <!-- ページネーター -->
    <mat-paginator [pageSizeOptions]="[10, 25, 50, 100]" showFirstLastButtons></mat-paginator>
    }
</div>